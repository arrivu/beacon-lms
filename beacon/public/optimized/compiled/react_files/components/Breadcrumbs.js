(function(){var e=[].slice;define(["i18n!react_files","jquery","underscore","react","react-router","./BreadcrumbCollapsedContainer","compiled/react/shared/utils/withReactDOM","../modules/customPropTypes"],function(t,r,s,n,l,o,h,u){var c,m,d,f;return m=l.Link,d=500,f=40,c=n.createClass({displayName:"Breadcrumbs",propTypes:{rootTillCurrentFolder:n.PropTypes.arrayOf(u.folder).isRequired},getInitialState:function(){return{maxCrumbWidth:d,availableWidth:2e5}},componentWillMount:function(){return this.fixOldCrumbs()},componentDidMount:function(){return r(window).on("resize",this.handleResize),this.handleResize()},componentWillUnmount:function(){return r(window).off("resize",this.handleResize)},fixOldCrumbs:function(){var e,t,i,s,a,n;return t=r("#breadcrumbs"),a=1.5*t.find("li:visible:first").height(),n=t.find(".home").text(),e=t.find("li").eq(1).find("a"),s=e.attr("href"),i=e.text(),t.remove(),this.setState({homeName:n,contextUrl:s,contextName:i,heightOfOneBreadcrumb:a})},handleResize:function(){return this.startRecalculating(window.innerWidth)},startRecalculating:function(e){return this.setState({availableWidth:e,maxCrumbWidth:d},this.checkIfCrumbsFit)},componentWillReceiveProps:function(){return setTimeout(this.startRecalculating)},checkIfCrumbsFit:function(){var e,t;if(this.state.heightOfOneBreadcrumb)return e=r(this.refs.breadcrumbs.getDOMNode()).height(),e>this.state.heightOfOneBreadcrumb&&this.state.maxCrumbWidth>f?(t=Math.max(f,this.state.maxCrumbWidth-20),this.setState({maxCrumbWidth:t},this.checkIfCrumbsFit)):void 0},renderSingleCrumb:function(e,r,i){var s;return s=i?t.t("files","Files"):e.get("name"),li({},m({to:i?"rootFolder":"folder",params:i?void 0:{splat:e.urlPath()},title:this.state.maxCrumbWidth<500?s:void 0},span({className:"ellipsis",style:{maxWidth:r?void 0:this.state.maxCrumbWidth}},s)))},renderDynamicCrumbs:function(){var r,i,s,a,n,l=this;return this.props.showingSearchResults?[this.renderSingleCrumb(null,!1,!0),li({},m({to:"search",query:this.props.query},span({className:"ellipsis"},this.props.query.search_term?t.t("search_results_for",'search results for "%{search_term}"',{search_term:this.props.query.search_term}):void 0)))]:(null!=(a=this.props.rootTillCurrentFolder)?a.length:void 0)?(n=this.props.rootTillCurrentFolder,r=2<=n.length?e.call(n,0,s=n.length-1):(s=0,[]),i=n[s++],this.state.maxCrumbWidth>f?this.props.rootTillCurrentFolder.map(function(e,t){return l.renderSingleCrumb(e,e===i,0===t)}):[o({foldersToContain:r}),this.renderSingleCrumb(i,!0)]):[]},render:h(function(){return nav({"aria-label":"breadcrumbs",role:"navigation",id:"breadcrumbs",ref:"breadcrumbs"},ul.apply(null,[{},li({className:"home"},a({href:"/"},i({className:"icon-home standalone-icon",title:this.state.homeName},span({className:"screenreader-only"},this.state.homeName)))),li({},a({href:this.state.contextUrl},span({className:"ellipsible"},this.state.contextName)))].concat(e.call(this.renderDynamicCrumbs()))))})})})}).call(this);