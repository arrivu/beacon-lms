(function(){define(["i18n!upload_button","react","compiled/react/shared/utils/withReactDOM","underscore","./FileRenameForm","../modules/customPropTypes","./ZipFileOptionsForm","../modules/FileOptionsCollection"],function(t,e,n,o,s,l,a,r){var p,d;return d=!1,p=e.createClass({displayName:"UploadButton",propTypes:{currentFolder:l.folder,contextId:e.PropTypes.string,contextType:e.PropTypes.string},getInitialState:function(){return r.getState()},queueUploads:function(){return this.refs.form.getDOMNode().reset(),r.queueUploads(this.props.contextId,this.props.contextType)},handleAddFilesClick:function(){return this.refs.addFileInput.getDOMNode().click()},handleFilesInputChange:function(){var t;return d=!1,t=this.refs.addFileInput.getDOMNode().files,r.setFolder(this.props.currentFolder),r.setOptionsFromFiles(t),this.setState(r.getState())},onNameConflictResolved:function(t){return r.onNameConflictResolved(t),d=!0,this.setState(r.getState())},onZipOptionsResolved:function(t){return r.onZipOptionsResolved(t),d=!0,this.setState(r.getState())},onClose:function(){return this.refs.form.getDOMNode().reset(),d||(r.resetState(),this.setState(r.getState())),d=!1},componentDidUpdate:function(){return 0===this.state.nameCollisions.length&&this.state.resolvedNames.length>0&&r.hasNewOptions()?this.queueUploads():d=!1},componentWillMount:function(){return r.onChange=this.setStateFromOptions},componentWillUnMount:function(){return r.onChange=null},setStateFromOptions:function(){return this.setState(r.getState())},buildPotentialModal:function(){return this.state.zipOptions.length?a({fileOptions:this.state.zipOptions[0],onZipOptionsResolved:this.onZipOptionsResolved,onClose:this.onClose}):this.state.nameCollisions.length?s({fileOptions:this.state.nameCollisions[0],onNameConflictResolved:this.onNameConflictResolved,onClose:this.onClose}):void 0},render:n(function(){return span({},form({ref:"form",className:"hidden"},input({type:"file",ref:"addFileInput",onChange:this.handleFilesInputChange,multiple:!0})),button({className:"btn btn-primary btn-upload","aria-label":t.t("upload","Upload"),onClick:this.handleAddFilesClick},i({className:"icon-upload"}),span({className:this.props.showingButtons?"hidden-phone":void 0},t.t("upload","Upload"))),this.buildPotentialModal())})})})}).call(this);