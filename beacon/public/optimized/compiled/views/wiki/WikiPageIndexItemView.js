(function(){var e={}.hasOwnProperty,t=function(t,i){function o(){this.constructor=t}for(var n in i)e.call(i,n)&&(t[n]=i[n]);return o.prototype=i.prototype,t.prototype=new o,t.__super__=i.prototype,t};define(["Backbone","underscore","compiled/views/wiki/WikiPageIndexEditDialog","compiled/views/wiki/WikiPageDeleteDialog","compiled/views/PublishIconView","jst/wiki/WikiPageIndexItem","compiled/jquery/redirectClickTo"],function(e,i,o,n,r,l){var s,p;return s=function(e){function s(){return p=s.__super__.constructor.apply(this,arguments)}return t(s,e),s.prototype.template=l,s.prototype.tagName="tr",s.prototype.className="clickable",s.prototype.attributes={role:"row"},s.prototype.els={".wiki-page-link":"$wikiPageLink",".publish-cell":"$publishCell"},s.prototype.events={"click a.al-trigger":"settingsMenu","click .edit-menu-item":"editPage","click .delete-menu-item":"deletePage","click .use-as-front-page-menu-item":"useAsFrontPage"},s.optionProperty("indexView"),s.optionProperty("collection"),s.optionProperty("WIKI_RIGHTS"),s.optionProperty("contextName"),s.prototype.initialize=function(){var e=this;return s.__super__.initialize.apply(this,arguments),this.WIKI_RIGHTS||(this.WIKI_RIGHTS={}),this.model.set("unpublishable",!0),this.model.on("change",function(){return e.render()})},s.prototype.toJSON=function(){var e,t=this;return e=s.__super__.toJSON.apply(this,arguments),e.CAN={MANAGE:!!this.WIKI_RIGHTS.manage,PUBLISH:!!this.WIKI_RIGHTS.manage&&"courses"===this.contextName},e.wiki_page_menu_tools=ENV.wiki_page_menu_tools,i.each(e.wiki_page_menu_tools,function(e){return e.url=e.base_url+("&pages[]="+t.model.get("page_id"))}),e},s.prototype.render=function(){var e;return null!=(e=this.publishIconView)&&e.$el.detach(),s.__super__.render.apply(this,arguments),this.publishIconView||(this.publishIconView=new r({model:this.model}),this.model.view=this),this.publishIconView.$el.appendTo(this.$publishCell),this.publishIconView.render()},s.prototype.afterRender=function(){return this.$el.find("td:first").redirectClickTo(this.$wikiPageLink)},s.prototype.settingsMenu=function(e){return null!=e?e.preventDefault():void 0},s.prototype.editPage=function(e){var t,i,n;return null!=e&&e.preventDefault(),i=new o({model:this.model}),i.open(),n=this.indexView,t=this.collection,i.on("success",function(){return n.currentSortField=null,n.renderSortHeaders(),t.fetch({page:"current"})})},s.prototype.deletePage=function(e){var t;return null!=e&&e.preventDefault(),this.model.get("deletable")?(t=new n({model:this.model}),t.open()):void 0},s.prototype.useAsFrontPage=function(e){return null!=e&&e.preventDefault(),this.model.get("published")?this.model.setFrontPage():void 0},s}(e.View)})}).call(this);