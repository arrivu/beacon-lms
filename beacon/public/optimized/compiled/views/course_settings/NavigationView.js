(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var a in n)t.call(n,a)&&(e[a]=n[a]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define(["jquery","Backbone"],function(t,i){var a,r;return a=function(i){function a(){return this.onKeyDown=e(this.onKeyDown,this),r=a.__super__.constructor.apply(this,arguments)}return n(a,i),a.prototype.keyCodes={32:"Space",38:"UpArrow",40:"DownArrow"},a.prototype.events={"click .disable_nav_item_link":"disableNavLink","click .move_nav_item_link":"moveNavLink","click .enable_nav_item_link":"enableNavLink"},a.prototype.els={"#nav_enabled_list":"$enabled_list","#nav_disabled_list":"$disabled_list","#move_nav_item_form":"$move_dialog",".navitem":"$navitems","#move_nav_item_name":"$move_name"},a.prototype.disableNavLink=function(e){var n;return n=t(e.currentTarget).closest(".navitem"),this.$disabled_list.append(n),t(e.currentTarget).attr("class","").attr("class","icon-plus enable_nav_item_link").text("Enable")},a.prototype.enableNavLink=function(e){var n;return n=t(e.currentTarget).closest(".navitem"),this.$enabled_list.append(n),t(e.currentTarget).attr("class","").attr("class","icon-x disable_nav_item_link").text("Disable")},a.prototype.moveNavLink=function(e){var n,i,a,r,o;return i=this.$move_dialog,o=t(e.currentTarget).closest(".nav_list"),r=t(e.currentTarget).closest(".navitem"),a=[],o.children(".navitem").each(function(e,n){return t(n).attr("aria-label")!==r.attr("aria-label")?a.push('<option value="'+t(n).attr("id")+'">'+t(n).attr("aria-label")+"</option>"):void 0}),n=this.$move_dialog.children().find("#move_nav_item_select"),n.empty(),n.append(a.join("")),this.$move_name.text(r.attr("aria-label")),this.$move_dialog.data("current_item",r),this.$move_dialog.dialog({modal:!0,width:600,height:300,close:function(){return i.dialog("close")}})},a.prototype.moveSubmit=function(e){var n,i,a;return e.preventDefault(),i=t("#move_nav_item_form").data("current_item"),n=t('[name="move_location"]:checked').val(),a=t("#"+t("#move_nav_item_select").val()),"before"===n&&a.before(i),"after"===n&&a.after(i),t("#move_nav_item_form").dialog("close"),i.focus()},a.prototype.cancelMove=function(){return t("#move_nav_item_form").dialog("close")},a.prototype.focusKeyboardHelp=function(){return t(".drag_and_drop_warning").removeClass("screenreader-only")},a.prototype.hideKeyboardHelp=function(){return t(".drag_and_drop_warning").addClass("screenreader-only")},a.prototype.afterRender=function(){return this.keyCodes="function"==typeof Object.freeze?Object.freeze(this.keyCodes):void 0,t("li.navitem").on("keydown",this.onKeyDown),t("#move_nav_item_cancel_btn").on("click",this.cancelMove),this.$move_dialog.on("submit",this.moveSubmit),t("#navigation_tab").on("blur",this.focusKeyboardHelp),t(".drag_and_drop_warning").on("blur",this.hideKeyboardHelp)},a.prototype.onKeyDown=function(e){var n,i;return n=t(e.target),i="on"+this.keyCodes[e.keyCode]+"Key",this[i]?this[i].call(this,e,n)&&e.preventDefault():void 0},a.prototype.onUpArrowKey=function(e,t){var n;return n=t.prev("li.navitem"),this.empty(n)&&(n=t.children("li.navitem").first()),this.empty(n)&&this.disabled(t)&&(n=this.$enabled_list.children("li.navitem").last(),this.empty(n)&&(n=this.$enabled_list,n.attr("tabindex",0),n.bind("keydown",this.onKeyDown))),n.focus()},a.prototype.onDownArrowKey=function(e,t){var n;return n=t.next("li.navitem"),this.empty(n)&&(n=t.children("li.navitem").first()),this.empty(n)&&this.enabled(t)&&(n=this.$disabled_list.children("li.navitem").first(),this.empty(n)&&(n=this.$disabled_list,n.attr("tabindex",-1),n.bind("keydown",this.onKeyDown))),n.focus()},a.prototype.onSpaceKey=function(e,t){var n;return(n=this.$el.data("drag"))?(t.is(n)||(t.is("li.navitem")?t.after(n):(t.append(n),t.attr("tabindex",-1),t.unbind("keydown"))),n.attr("aria-grabbed",!1),this.$el.data("drag",null),n.focus()):t.is("li.navitem")?(t.attr("aria-grabbed",!0),n=t,this.$el.data("drag",n),n.blur(),n.focus()):void 0},a.prototype.empty=function(e){return 0===e.length},a.prototype.enabled=function(e){return e.parent().attr("id")===this.$enabled_list.attr("id")},a.prototype.disabled=function(e){return e.parent().attr("id")===this.$disabled_list.attr("id")},a}(i.View)})}).call(this);