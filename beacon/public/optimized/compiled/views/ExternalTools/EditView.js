(function(){var t=function(t,r){return function(){return t.apply(r,arguments)}},r={}.hasOwnProperty,e=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};define(["i18n!external_tools","jquery","jst/ExternalTools/EditView","compiled/views/ValidatedFormView","compiled/jquery/fixDialogButtons"],function(r,o,i,n){var a,s;return a=function(n){function a(){return this.onSaveFail=t(this.onSaveFail,this),s=a.__super__.constructor.apply(this,arguments)}return e(a,n),a.prototype.template=i,a.prototype.tagName="form",a.prototype.id="external_tool_form",a.prototype.className="validated-form-view form-horizontal bootstrap-form",a.prototype.events={"change #external_tool_config_type":"onConfigTypeChange"},a.prototype.initialize=function(){return a.__super__.initialize.apply(this,arguments),this.title=this.options.title||r.t("dialog_title_edit_tool","Edit External Tool")},a.prototype.afterRender=function(){var t=this;return a.__super__.afterRender.apply(this,arguments),this.$el.dialog({title:this.title,width:520,height:"auto",resizable:!0,close:function(){return t.$el.remove()},buttons:[{"class":"btn-primary",text:r.t("submit","Submit"),"data-text-while-loading":r.t("saving","Saving..."),click:function(){return t.submit()}}]}),this.onConfigTypeChange(),this.$el.submit(function(){return t.submit(),!1}),this},a.prototype.submit=function(){return this.$el.parent().find(".btn-primary").removeClass("ui-state-hover"),a.__super__.submit.apply(this,arguments)},a.prototype.onConfigTypeChange=function(){var t;return t=this.$("#external_tool_config_type").val(),this.$(".config_type").hide().attr("aria-expanded",!1),this.$(".config_type."+t).show().attr("aria-expanded",!0)},a.prototype.showErrors=function(t){var r,e,o,i,n,a;this.removeErrors(),a=[];for(o in t)e=t[o],r=this.findField(o),i=function(){var t,r,o;for(o=[],t=0,r=e.length;r>t;t++)n=e[t].message,o.push(this.translations[n]||n);return o}.call(this).join("</p><p>"),a.push(this.addError(r,i));return a},a.prototype.removeErrors=function(){return this.$(".error .help-inline").remove(),this.$(".control-group").removeClass("error"),this.$(".alert.alert-error").remove()},a.prototype.addError=function(t,r){return t=o(t),t.parents(".control-group").addClass("error"),t.after("<span id='"+t.attr("name")+"_error_message' class='help-inline'>"+r+"</span>"),t.attr("aria-describedby",""+t.attr("name")+"_error_message"),t.attr("aria-invalid","true"),t.one("keypress",function(){return o(this).parents(".control-group").removeClass("error"),t.removeAttr("aria-describedby"),o(this).removeAttr("aria-invalid"),o(this).parents(".control-group").find(".help-inline").remove()})},a.prototype.onSaveFail=function(){var t,e;return a.__super__.onSaveFail.apply(this,arguments),e=r.t("generic_error","There was an error in processing your request"),this.$el.prepend("<div class='alert alert-error'>"+e+"</span>"),(t=function(t,r){return setTimeout(r,t)})(1,function(){return this.$("[aria-invalid='true']").first().focus()})},a}(n)})}).call(this);