(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,o=function(e,o){function r(){this.constructor=e}for(var a in o)t.call(o,a)&&(e[a]=o[a]);return r.prototype=o.prototype,e.prototype=new r,e.__super__=o.prototype,e};define(["i18n!assignment","Backbone","underscore","jquery","jst/assignments/GroupCategorySelector","compiled/jquery/toggleAccessibly"],function(t,r,a,i,n){var s,p;return s=function(r){function s(){return this._validateGroupCategoryID=e(this._validateGroupCategoryID,this),this.validateBeforeSave=e(this.validateBeforeSave,this),this.filterFormData=e(this.filterFormData,this),this.toJSON=e(this.toJSON,this),this.toggleGroupCategoryOptions=e(this.toggleGroupCategoryOptions,this),this.showGroupCategoryCreateDialog=e(this.showGroupCategoryCreateDialog,this),p=s.__super__.constructor.apply(this,arguments)}var g,u,d;return o(s,r),s.prototype.template=n,g="#assignment_group_category_id",d="#has_group_category",u="#group_category_options",s.prototype.els=function(){var e;return e={},e[""+g]="$groupCategoryID",e[""+d]="$hasGroupCategory",e[""+u]="$groupCategoryOptions",e}(),s.prototype.events=function(){var e;return e={},e["change "+g]="showGroupCategoryCreateDialog",e["change "+d]="toggleGroupCategoryOptions",e}(),s.optionProperty("parentModel"),s.optionProperty("groupCategories"),s.optionProperty("nested"),s.optionProperty("hideGradeIndividually"),s.optionProperty("sectionLabel"),s.optionProperty("fieldLabel"),s.optionProperty("lockedMessage"),s.prototype.showGroupCategoryCreateDialog=function(){var e=this;return"new"===this.$groupCategoryID.val()?window.addGroupCategory(function(t){var o,r;return r=t[0].group_category,o=i("<option>"),o.val(r.id),o.text(r.name),e.$groupCategoryID.prepend(o),e.$groupCategoryID.val(r.id),e.groupCategories.push(r)}):void 0},s.prototype.toggleGroupCategoryOptions=function(){return this.$groupCategoryOptions.toggleAccessibly(this.$hasGroupCategory.prop("checked")),this.$hasGroupCategory.prop("checked")&&0===this.groupCategories.length?this.showGroupCategoryCreateDialog():void 0},s.prototype.toJSON=function(){var e,t,o,r;return e=("function"==typeof(r=this.parentModel).frozenAttributes?r.frozenAttributes():void 0)||[],t=a.include(e,"group_category_id"),o=!this.parentModel.canGroup(),{groupCategoryId:this.parentModel.groupCategoryId(),groupCategories:this.groupCategories,hideGradeIndividually:this.hideGradeIndividually,gradeGroupStudentsIndividually:!this.hideGradeIndividually&&this.parentModel.gradeGroupStudentsIndividually(),groupCategoryLocked:o,hasGroupCategoryDisabled:t||o,gradeIndividuallyDisabled:t,groupCategoryIdDisabled:t||o,differentiatedAssignmentsEnabled:this.parentModel.differentiatedAssignmentsEnabled(),sectionLabel:this.sectionLabel,fieldLabel:this.fieldLabel,lockedMessage:this.lockedMessage,ariaChecked:this.parentModel.groupCategoryId()?"true":"false",nested:this.nested,prefix:this.nested?"assignment":void 0}},s.prototype.filterFormData=function(e){var t;return t=e.has_group_category,delete e.has_group_category,"0"===t&&(e.group_category_id=null,e.grade_group_students_individually=!1),e},s.prototype.fieldSelectors={groupCategorySelector:"#assignment_group_category_id"},s.prototype.validateBeforeSave=function(e,t){return t=this._validateGroupCategoryID(e,t)},s.prototype._validateGroupCategoryID=function(e,o){var r;return r=this.nested?e.assignment.groupCategoryId():e.group_category_id,"new"===r&&(o.groupCategorySelector=[{message:t.t("group_assignment_must_have_group_set","Please select a group set for this assignment")}]),o},s}(r.View)})}).call(this);