(function(){define(["underscore","i18n!react_files","react","react-router","compiled/react/shared/utils/withReactDOM","./UploadButton","../utils/openMoveDialog","../utils/downloadStuffAsAZip","../utils/deleteStuff","../modules/customPropTypes","./RestrictedDialogForm","jquery","compiled/jquery.rails_flash_notifications"],function(e,t,s,o,r,n,l,a,c,d,p,u){var h;return h=s.createClass({displayName:"Toolbar",mixins:[o.Navigation],propTypes:{currentFolder:d.folder,contextType:d.contextType.isRequired,contextId:d.contextId.isRequired},onSubmitSearch:function(e){var t;return e.preventDefault(),t={search_term:this.refs.searchTerm.getDOMNode().value},this.transitionTo("search",{},t)},addFolder:function(e){return e.preventDefault(),this.props.currentFolder.folders.add({})},downloadSelectedAsZip:function(){return a(this.props.selectedItems,{contextType:this.props.contextType,contextId:this.props.contextId})},componentDidUpdate:function(e){return e.selectedItems.length!==this.props.selectedItems.length?u.screenReaderFlashMessage(t.t("count_items_selected","%{count} items selected",{count:this.props.selectedItems.length})):void 0},getPreviewQuery:function(){var e,t;if(this.props.selectedItems.length)return e={preview:this.props.selectedItems[0].id},1!==this.props.selectedItems.length&&(e.only_preview=this.props.selectedItems.map(function(e){return e.id}).join(",")),(null!=(t=this.props.query)?t.search_term:void 0)&&(e.search_term=this.props.query.search_term),e},getPreviewRoute:function(){var e,t;return(null!=(e=this.props.query)?e.search_term:void 0)?"search":(null!=(t=this.props.currentFolder)?t.urlPath():void 0)?"folder":"rootFolder"},openRestrictedDialog:function(){var e;return e=u("<div>").dialog({title:t.t("title.permissions","Editing permissions for %{count} items",{count:this.props.selectedItems.length}),width:400,close:function(){return s.unmountComponentAtNode(this),u(this).remove()}}),s.renderComponent(p({models:this.props.selectedItems,closeDialog:function(){return e.dialog("close")}}),e[0])},render:r(function(){var e,s,r,a=this;return s=this.props.selectedItems.length,e=1===this.props.selectedItems.length?t.t("download","Download"):t.t("download_as_zip","Download as Zip"),header({className:"ef-header grid-row between-xs",role:"region","aria-label":t.t("files_toolbar","Files Toolbar")},form({className:"col-lg-3 "+(s?"col-xs-4 col-sm-3 col-md-4":"col-xs-7 col-sm-5 col-md-4"),onSubmit:this.onSubmitSearch},input({placeholder:t.t("search_for_files","Search for files"),"aria-label":t.t("search_for_files","Search for files"),type:"search",ref:"searchTerm",defaultValue:this.props.query.search_term})),div({className:"ui-buttonset col-xs "+(s?void 0:"screenreader-only")},o.Link({to:this.getPreviewRoute(),query:this.getPreviewQuery(),splat:null!=(r=this.props.currentFolder)?r.urlPath():void 0,className:"ui-button btn-view",title:t.t("view","View"),"data-tooltip":""},i({className:"icon-search"})),this.props.userCanManageFilesForContext?button({disabled:!s,className:"ui-button btn-restrict",onClick:this.openRestrictedDialog,title:t.t("restrict_access","Restrict Access"),"aria-label":t.t("restrict_access","Restrict Access"),"data-tooltip":""},i({className:"icon-unpublished"})):void 0,button({disabled:!s,className:"ui-button btn-download",onClick:this.downloadSelectedAsZip,title:e,"aria-label":e,"data-tooltip":""},i({className:"icon-download"})),this.props.userCanManageFilesForContext?button({disabled:!s,className:"ui-button btn-move",onClick:function(e){return l(a.props.selectedItems,{contextType:a.props.contextType,contextId:a.props.contextId,returnFocusTo:e.target})},title:t.t("move","Move"),"aria-label":t.t("move","Move"),"data-tooltip":""},i({className:"icon-copy-course"})):void 0,this.props.userCanManageFilesForContext?button({disabled:!s,className:"ui-button btn-delete",onClick:function(){return c(a.props.selectedItems)},title:t.t("delete","Delete"),"aria-label":t.t("delete","Delete"),"data-tooltip":""},i({className:"icon-trash"})):void 0,span({className:"hidden-tablet hidden-phone",style:{paddingLeft:13}},t.t("count_items_selected","%{count} items selected",{count:this.props.selectedItems.length}))),this.props.userCanManageFilesForContext?div({className:"text-right"},span({className:"ui-buttonset"},button({onClick:this.addFolder,className:"btn btn-add-folder","aria-label":t.t("add_folder","Add Folder")},i({className:"icon-plus"}),span({className:s?"hidden-phone":void 0},t.t("folder","Folder")))),span({className:"ui-buttonset"},n({currentFolder:this.props.currentFolder,showingButtons:s,contextId:this.props.contextId,contextType:this.props.contextType}))):void 0)})})})}).call(this);