(function(){define(["react","i18n!react_files","compiled/react/shared/utils/withReactDOM","compiled/str/splitAssetString","./Toolbar","./Breadcrumbs","./FolderTree","./FilesUsage","../mixins/MultiselectableMixin","../mixins/dndMixin","../modules/filesEnv"],function(e,t,r,s,l,o,i,n,c,d,h){var u;return u=e.createClass({displayName:"FilesApp",onResolvePath:function(e){var t,r,s,l;return t=e.currentFolder,r=e.rootTillCurrentFolder,l=e.showingSearchResults,s=e.searchResultCollection,this.setState({currentFolder:t,rootTillCurrentFolder:r,showingSearchResults:l,selectedItems:[],searchResultCollection:s})},getInitialState:function(){return{currentFolder:void 0,rootTillCurrentFolder:void 0,showingSearchResults:!1,selectedItems:void 0}},mixins:[c,d],selectables:function(){return this.state.showingSearchResults?this.state.searchResultCollection.models:this.state.currentFolder.children(this.props.query)},render:r(function(){var e,r,s;return this.state.currentFolder?(r=this.state.currentFolder.get("context_type").toLowerCase()+"s",e=this.state.currentFolder.get("context_id")):(r=h.contextType,e=h.contextId),s=h.userHasPermission({contextType:r,contextId:e},"manage_files"),div(null,header({},h1({className:"screenreader-only"},t.t("files_heading","Files"))),o({rootTillCurrentFolder:this.state.rootTillCurrentFolder,query:this.props.query,showingSearchResults:this.state.showingSearchResults}),l({currentFolder:this.state.currentFolder,query:this.props.query,selectedItems:this.state.selectedItems,clearSelectedItems:this.clearSelectedItems,contextType:r,contextId:e,userCanManageFilesForContext:s}),div({className:"ef-main"},aside({className:"visible-desktop ef-folder-content",role:"region","aria-label":t.t("folder_browsing_tree","Folder Browsing Tree")},i({rootTillCurrentFolder:this.state.rootTillCurrentFolder,rootFoldersToShow:h.rootFolders,dndOptions:{onItemDragEnterOrOver:this.onItemDragEnterOrOver,onItemDragLeaveOrEnd:this.onItemDragLeaveOrEnd,onItemDrop:this.onItemDrop}})),div({className:"ef-directory",role:"region","aria-label":t.t("file_list","File List")},this.props.activeRouteHandler({onResolvePath:this.onResolvePath,currentFolder:this.state.currentFolder,contextType:r,contextId:e,selectedItems:this.state.selectedItems,toggleItemSelected:this.toggleItemSelected,toggleAllSelected:this.toggleAllSelected,areAllItemsSelected:this.areAllItemsSelected,userCanManageFilesForContext:s,dndOptions:{onItemDragStart:this.onItemDragStart,onItemDragEnterOrOver:this.onItemDragEnterOrOver,onItemDragLeaveOrEnd:this.onItemDragLeaveOrEnd,onItemDrop:this.onItemDrop}}))),div({className:"ef-footer grid-row"},s?n({className:"col-xs-3",contextType:r,contextId:e}):void 0,h.showingAllContexts?void 0:div({className:"col-xs"},div({},a({className:"pull-right",href:"/files?show_all_contexts=1"},t.t("all_my_files","All My Files"))))))})})})}).call(this);